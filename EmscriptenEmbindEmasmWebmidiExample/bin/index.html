<!doctypehtml>
<html lang=en-us>
    <head>
        <title>av</title>
        <style>
            .emscripten {
                position: absolute;
                width: 640px;
                height: 360px;
                top: 350px;
                left: 650px;
                margin: -300px 0 0 -400px;
            }
        </style>
    </head>
        <body bgcolor="lightGreen">
        <div class=spinner id=spinner></div>
        <div class=emscripten id=status>Downloading...</div>
        <div class=emscripten>
            <progress hidden id=progress max=100 value=0></progress>
        </div>
        <div class=emscripten_border>
            <canvas class=emscripten id=canvas oncontextmenu=event.preventDefault()></canvas>
            <script>
                var statusElement = document.getElementById("status")
                  , progressElement = document.getElementById("progress")
                  , spinnerElement = document.getElementById("spinner")
                  , Module = {
                    preRun: [],
                    postRun: [],
                    print: function() {
                        var t = document.getElementById("output");
                        return t && (t.value = ""),
                        function(e) {
                            1 < arguments.length && (e = Array.prototype.slice.call(arguments).join(" ")),
                            console.log(e),
                            t && (t.value += e + "\n",
                            t.scrollTop = t.scrollHeight)
                        }
                    }(),
                    printErr: function(e) {
                        1 < arguments.length && (e = Array.prototype.slice.call(arguments).join(" ")),
                        console.error(e)
                    },
                    canvas: function() {
                        var e = document.getElementById("canvas");
                        return e.addEventListener("webglcontextlost", function(e) {
                            alert("WebGL context lost. You will need to reload the page."),
                            e.preventDefault()
                        }, !1),
                        e
                    }(),
                    setStatus: function(e) {
                        if (Module.setStatus.last || (Module.setStatus.last = {
                            time: Date.now(),
                            text: ""
                        }),
                        e !== Module.setStatus.text) {
                            var t = e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/)
                              , n = Date.now();
                            t && n - Date.now() < 30 || (t ? (e = t[1],
                            progressElement.value = 100 * parseInt(t[2]),
                            progressElement.max = 100 * parseInt(t[4]),
                            progressElement.hidden = !1,
                            spinnerElement.hidden = !1) : (progressElement.value = null,
                            progressElement.max = null,
                            progressElement.hidden = !0,
                            e || (spinnerElement.style.display = "none")),
                            statusElement.innerHTML = e)
                        }
                    },
                    totalDependencies: 0,
                    monitorRunDependencies: function(e) {
                        this.totalDependencies = Math.max(this.totalDependencies, e),
                        Module.setStatus(e ? "Preparing... (" + (this.totalDependencies - e) + "/" + this.totalDependencies + ")" : "All downloads complete.")
                    }
                };
                Module.setStatus("Downloading..."),
                window.onerror = function(e) {
                    Module.setStatus("Exception thrown, see JavaScript console"),
                    spinnerElement.style.display = "none",
                    Module.setStatus = function(e) {
                        e && Module.printErr("[post-exception status] " + e)
                    }
                }
            </script>
<script async src=EmscriptenEmbindEmasmWebmidiExample.js></script>
<script>  
Object.defineProperty(window, "arr", { set: function(v)
{
  // console.log("midiOut: ", v); 
  sendMIDI(v);
  document.getElementById("midi-data").textContent = v.slice(0,3); 
  } } );              
  Module['postRun'] = function()
  {
    var vec = new Module.StringList();
    var list = [23,3332,1,12,4,343,3];
    for (i = 0; i < list.length; i++) {
    vec.push_back(list[i]);
  }           
  Module.function_1(20);
  Module.function_2(60);
  Module.function_3(100);
  Module.function_4(vec);         
};
</script>
<strong>R: </strong>
<form>
<input type="range" id="R" name="R_range" min="1" max="500" step="1" value="8"  oninput="calculate_1(), this.form.R_input.value=this.value"/>
<input type="number" name="R_input" min="1" max="500" value="8" oninput= "calculate_1(), this.form.R_range.value=this.value"/>
</form>
<br>
<script>
function calculate_1() 
{
  var vec = new Module.StringList();
  var list = [23,32,1,199,parseFloat(document.getElementById("R").value),343,3];
  for (i = 0; i < list.length; i++) {
  vec.push_back(list[i]);
}
Module.function_1(parseFloat(document.getElementById("R").value));
Module.function_4(vec);
}
</script>
<strong>G: </strong>
<form>
<input type="range" id="G" name="G_range" min="1" max="250" step="1" value="8"  oninput="calculate_2(), this.form.G_input.value=this.value"/>
<input type="number" name="G_input" min="1" max="250" value="8" oninput= "calculate_2(),this.form.G_range.value=this.value"/>
</form>
<br>
<script>
var G = 8; 
function calculate_2() 
{
  Module.function_2(parseFloat(document.getElementById("G").value));
  G = document.getElementById("G").value;
}
</script>
<strong>B: </strong>
<form>
<input type="range" id="B" name="B_range" min="1" max="250" step="1" value="8"  oninput="calculate_3(), this.form.B_input.value=this.value"/>
<input type="number" name="B_input" min="1" max="250" value="8" oninput= "calculate_3(),this.form.B_range.value=this.value"/>
</form>
<br>
<script>
function updateMIDI(value) 
{
  document.getElementById("midi-data").textContent = value;
}
function calculate_3() 
{
  Module.function_3(parseFloat(document.getElementById("B").value));
}
</script>
<b>Input Ports: </b><select id="midiIn"><option>-no MIDI-</option></select><br></p>
<b>Outputs Ports: </b><select id="midiOut"><option>-no MIDI-</option></select></p>
<b>MIDI Messages: <b id="midi-data" onchange="updateMIDI(value)">0,0,0</b></p> 
<b>GM Instrument MIDI Out Channel 1:</b></p>
<select id='ins' onchange="selectIns(this)"></select></p>
<script type="text/javascript" src="midi.js"></script>
</body>
</html>

